# 这是Aya_Uchida(hustmch)的计算机学习日记

## 前言

之前的学习日记都是记录在自己的手机上的，但是我觉得记录在手机上一篇篇的话，连着看就很麻烦，所以我就考虑整理一下放到github好了。这也是学习了[SKTT1Ryze (hustccc) (github.com)](https://github.com/SKTT1Ryze)的非常好的idea，这将是一个随缘更新的长期项目。

## 2021.1.28

距离寒假开始已经一个月了，我的咸鱼状态也越来越重，中午才起床，然后边吃东西边看游戏视频，然后下午随便写了一道题，就又玩游戏玩到了晚上9点，然后睡觉，这就是我浑浑噩噩的一天，我想，是时候要花费一些精力把我从之前的生活中拉回来了，但是我要怎么做呢。

## 2021.2.6

前几天和朋友商量了一下共同开发一个小数据库[sohardforaname/AyasonDB: A simple database implemented by Aya_Uchida and Navi_Awson affiliated to HUST (github.com)](https://github.com/sohardforaname/AyasonDB)的想法，然后我也看了一下数据库系统实现，针对我们的数据库的开发目的，结合了书上对数据结构的介绍，最终决定了用B+树，纯C语言开发这个小数据库。然后今天起床还是有点晚，虽然已经在慢慢变好了，刚好五等分更新了，好耶！然后就看了一集五等分，然后写了几道SAM的题和border tree的题，不写题实力马上就不行了，lca都写不出来了呜呜呜，然后因为一些bug也RE了好几发，计划明天继续写db了，希望能写完string类和vector类。

## 2021.2.10

2月8号突发奇想，想看看快读的边界在哪里，我就写了一个叫FastIO[sohardforaname/FastIO: A fast IO class based on fread, used in programming contests and other situations requiring high performance IO. (github.com)](https://github.com/sohardforaname/FastIO)的算法竞赛读入库，然后学了一些C++11和C++14的新特性，把一些工作全部提前到编译期完成，然后昨天和今天就沉迷在性能优化里面，2月9日做了分支减少和计算改为查表，然后我想因为访存通常来说是需要耗费一些时钟周期的，这样子的话会不会有些计算过程不改成查表还会快一些呢？然后我对怎么利用超标量流水线和乱序发射的CPU，还有一些不懂的地方，所以最终优化成果也只是比朴素实现快2.5倍而已（103M纯32bit数字，250M/s），这个时候就开始进入挤牙膏的模式了，得边学习前人的经验边用性能分析器了。

然后趁此机会，我想学一下folly的STL实现，然后春节期间先不写新题了，就随便补一下题好了。

## 2021.2.12

又忙了两天，加入了SIMD指令优化，重构了某些函数，把速度提到了350M/s，处理字符读入的速度提到了550M/s，整个项目一共600行代码，除了核心，我还用了一下装饰器模式，用户可以利用可变参数模板和万能引用方便的读入想要的基本类型数据和数组，vector，详见FastIO的文档和源码吧2333。然后起床时间还是很晚呜呜呜，这好吗？这不好。如果我早起一点，可能可以写多一点吧？最后……刷了一下知乎，感觉现在女拳泛滥。

## 2021.2.20

准备要回学校了，这次的日记主要是记录自己的感悟吧，大学时光真的过得好快啊，转眼间我也是快要毕业的人了，大学和高中最大的区别就是，高中是在一种高压和单一目标下的竞争，所以目标其实是明确的，人就不容易迷茫，大学之后，一个是宽松的环境，一个是缺乏指导，更重要的是自己的迷茫性。人会陷入一种奇怪的放松中，等到自己发现自己已经发现自己的问题时，已经有点晚了。坏习惯已经养成了。所以时刻都要记住要时常观察自己和调整自己，这也是我写这个日记的想法之一。

## 2021.2.28

回到学校了，寒假已经在我的身后了，无论留下多少遗憾与未完成之事情，都要继续规划自己，继续出发了，时间已经不多了，不能摸鱼了，新学期的话，就以完成Java课设（大型项目），优化FastIO，优化GEMM，看源码和acm银牌为自己的目标吧。

我在回来之前投了字节跳动和微信事业群的岗位，微信事业群还没通知，字节倒是速度很快，2.26就联系我去面试了，我即将迎来我人生中的第一场面试了，在火车上背了一下面经，发现面经都是我的专业课本上白纸黑字写着的东西。唉，如果我当时不轻信“学长”的话翘课的话，现在会不会就不用这么辛苦的背面经了呢？只能说，出来混总要还的。

虽然面经被大家称为“八股”，我仍然觉得，知其然，不知其所以然者，不可谓知之也。深挖之后，我仍然能获得很多的书本上没有的知识。就像type_traits，iterator_traits这些，大家都会背的八股，谁能想到，它为我优化（a+b）%c（a,b,c是同一种整数数据类型）的式子时，提供了零运行时开销的思路（其实在limits头文件里面这个已经实现了，但是自己造造简单的轮子学习一下未尝不可）。最终我的优化实现比朴素实现快2.2倍。

## 2021.3.5

面试完了之后自我感觉还可以，然后第二天早上字节的hr就打电话来说跟我约二面的时间。

但是我觉得自己在很多知识点上还是只知道个大概，如果在细节上深挖的话，我绝对会招架不住的，所以我一面和二面的时间隔了一个星期，然后我趁此机会刷了一下leetcode，然后对自己在一面时不会的知识点继续深挖了一下（实际上这还是我的专业课课本上的知识，所以翘课自学是多么的讽刺的事情），一下午做出19道力扣middle题，我还是很有成就感的。然后期间投了一个pingcap的岗位，pingcap上来就是一个小作业[sohardforaname/pingcapDemo: A simple index builder for pingcap job interview (github.com)](https://github.com/sohardforaname/pingcapDemo)，写这个小作业还是花了我很多时间，这也是我第一次写文件和内存联动的程序，然后第一次实现布隆过滤器。pingcap还是一个很有水平的公司。

我到现在为止还没对自己学过的东西做深入的归纳和总结。所以近期也要开始做这件事情了。

时间越来越少了。但是我的步伐也加快了。

## 2021.3.6

写完了pingcap的小作业，但是还有一个bug我百思不得其解，不过最后查出是ftell函数的问题。一番修改之后终于把这个bug修改了，吸取教训了，以后用自己没用过的函数要查查reference。但是这个小作业还有更大的bug。尤其是在数据量大的时候。但是我的事情太多了，只能留下这个遗憾了。但是一个kv引擎里面，像这个小作业这样的算法大概还是会大量使用的，所以我也把它列入了我的项目计划（划掉，有生之年计划）中。

去看了一会B站，发现了一个可爱的up主[草莓味の喵喵酱的个人空间 - 哔哩哔哩 ( ゜- ゜)つロ 乾杯~ Bilibili](https://space.bilibili.com/65764710/dynamic)，她的mc视频还蛮有趣的，关注了关注了。

## 2021.3.7

准备面试中，重点学习了linux内存管理机制，ELF文件格式的内存分布，C++类和对象的复杂问题，智能指针，锁和条件变量啥的，当作复习吧。

## 2021.3.10

今天有点压抑，不过早上hr打电话来说约三面，我自己真的觉得我的二面贼拉垮，但是既然过了，就继续准备三面吧！

## 2021.3.11

没想到我pingcap的小作业居然过了，然后也和hr约好了面试时间。加油！

## 2021.3.14

字节的三面和hr面有惊无险地通过了，pingcap一面答得不是很好，但是最后算法题还是写出来了。所以我大概觉得挂了，所以自己接受了这个想法，准备等着面挂的通知。

然后既然字节过了，我也不想面试其他公司了，回归codeforces继续训练比较好，然后我想了一下，我大四阶段看我今年的实习如何，如果不太喜欢后端的话，我就去学计算机图形学和写渲染引擎了。如果后端还不错的话，就打算深挖分布式kv引擎和图计算相关的知识。

## 2021.3.18

？？？太怪了，我的pingcap一面居然过了？？？我整个人吓坏了，不过也不能不顾现实，就是我对计网和os的巨大的知识缺陷。

继续学习吧。

## 2021.3.21

爆肝了一周mc，打RageCraft3让我的pve技术大大提高了，但是整个过程太折磨人了，有点ptsd了。下一周就肝完组原课设吧！

## 2021.3.26

同意了字节的offer，然后面完了微信事业群，我觉得微信事业群的面试官真的是面面俱到，知识面极广。我虽然整理了一次面经，但是我的知识漏洞仍然巨大，源码级的理解也相当不到位。正如牛顿所说：我好象一个在海边玩耍的孩子，不时为拾到比通常更光滑的石子或更美丽的贝壳而欢欣鼓舞，而展现在我面前的是完全未探明的真理之海。

然后就是老生常谈的学习了。学习和做事讲究扬长避短。我现在的优点就是acm底子带来的较好的代码力和算法水平，然后不足的地方是对于大型的组件，中间件，os的知识仍然非常缺乏，对于非acm的算法了解也同样很少，这是我应该在之后的学习中应该着重学习的三个点，在学习的时候，也要如在字节跳动Open Day时和学长交流的时候学长所说的，要不断抽象和总结模型和算法，提高效率和知识的完整性。

## 2021.3.28

肝完了Java课设，准备开始debug。我校的Java课设是实现一个搜索引擎，之前面试微信事业群的时候，面试官和我说我的项目太小了，希望我能做一个完整的，较大型的项目。所以我就打算利用Java课设的契机，完成这个目标：经过拆分，这个项目大方向分为以下4个步骤：

-   stage 1：在2021.3.31前完成基础的功能（内存型搜索引擎，处理倒排索引和序列化，反序列化）
-   stage 2：在2021.4.7前完成并发查询支持和简单的前端页面支持。
-   stage 3：在2021.4.21之前完成使用数据库存储文章的功能，同时并发机制使用消息队列完成。
-   stage 4：在2021.5.20之前完成基于分布式服务框架的多机高性能搜索引擎。

## 2021.4.2

首先说说前面的事情。

总体来说，我的三月就这么过去了，首先我还是觉得非常幸运，面试通过了字节的后台开发岗位（3+1），pingcap一面和wxg一面，五次面试无一败绩。成绩斐然。然后代码统计量是97k行代码（其中刷题代码占80%），利用较为扎实的C++基础，使用35h在Java零基础的情况下完成了Java实验：https://github.com/sohardforaname/UcchiSearchEngine并通过全部测试， 平均每小时编写50行代码，这个速度还是相对来说令人满意的。

然后我收到wxg的二面通知，加油！

然后就是我的Java老师，辜希武老师，在听了我对Java实验搜索引擎的数据结构提出的优化（使用CompressedTrie，压缩Trie）代替哈希表的做法后，对这个数据结构表示出了兴趣。但是显然压缩Trie在具有大量重复前缀的单词集下，使用Trie是可以显著提高插入，删除，查询性能的，但是输出有序的字典的性能就会相对拖慢，因此我引入了Last-modified机制，以应付大量的返回字典的过程。但是如果是交替插入和返回有序字典的话，我的CompressedTrie仍然会达到平方级别的时间复杂度。这个我暂时不了解如何改进。

同时，我对搜索引擎是否能增量修改索引和如何进行增量修改索引仍然了解甚少。不解决的话，搜索引擎对于修改后的文章重新建立索引的代价将会非常高。希望有时间可以和老师探讨这个问题。

然后我简单实现了多关键字查询的机制，就是使用一个lexer进行token的处理（反正也只有key，OR和AND，所以parser是没有必要的）。然后根据逻辑计算的优先级设计了一个简单的算法进行查询和结果的合并。

如果搜索不到结果，我的搜索引擎也会计算出当前词和搜索引擎中词典中所有词的莱文斯坦距离（编辑距离），使用基于堆的算法返回距离最小的top-k。同时引入了基于注入的实现的读配置文件启动过滤器的方式。后者是在C++里面几乎是不可能完成的事情。

至此，我的第一版简单的基于内存的搜索引擎就写完了，stage 2要开始了。

然后就是想起了某些以前的事情，很烦，不知道怎么办，也许需要一些开导。或者继续修炼自己，不以物喜，不以己悲。

